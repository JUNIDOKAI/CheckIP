<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ki·ªÉm Tra IP, VPN, T·ªëc ƒê·ªô M·∫°ng</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

<button id="toggleDarkMode" class="btn btn-secondary">üåô Ch·∫ø ƒë·ªô t·ªëi</button>

<script>
    // Ki·ªÉm tra tr·∫°ng th√°i Dark Mode ƒë√£ l∆∞u
    if (localStorage.getItem("darkMode") === "enabled") {
        document.body.classList.add("dark-mode");
    }

    document.getElementById("toggleDarkMode").addEventListener("click", function () {
        document.body.classList.toggle("dark-mode");
        if (document.body.classList.contains("dark-mode")) {
            localStorage.setItem("darkMode", "enabled");
        } else {
            localStorage.setItem("darkMode", "disabled");
        }
    });
</script>

<style>
    /* Dark Mode */
    .dark-mode {
        background-color: #121212;
        color: white;
    }
    .dark-mode table {
        color: white;
    }
</style>

    <style>
        body { background-color: #f4f4f4; }
        .container { max-width: 600px; margin: auto; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
        .loading { font-size: 14px; color: gray; text-align: center; }
        #map { height: 300px; width: 100%; border-radius: 10px; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="container mt-4">
        <h2 class="text-center">üì° Ki·ªÉm Tra IP & T·ªëc ƒê·ªô M·∫°ng</h2>
        <button class="btn btn-primary w-100 mt-3" onclick="getInfo()">üîç Ki·ªÉm Tra Ngay</button>
        <div id="info" class="mt-3"></div>
        <div id="map"></div>
    </div>

<!-- B·∫£ng hi·ªÉn th·ªã th√¥ng tin -->
<table id="ipTable" class="table table-striped">
    <thead>
        <tr>
            <th>Th√¥ng Tin</th>
            <th>Chi Ti·∫øt</th>
        </tr>
    </thead>
    <tbody id="infoTableBody"></tbody>
</table>

<!-- Th√™m Bootstrap 5 & DataTables -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

<script>
    function updateTable(data) {
        let tableBody = document.getElementById("infoTableBody");
        tableBody.innerHTML = `
            <tr><td>ƒê·ªãa ch·ªâ IP</td><td>${data.ip}</td></tr>
            <tr><td>Nh√† m·∫°ng</td><td>${data.org}</td></tr>
            <tr><td>VPN/Proxy</td><td>${data.proxy ? "C√≥" : "Kh√¥ng"}</td></tr>
            <tr><td>T·ªëc ƒë·ªô m·∫°ng</td><td>${data.speed} Mbps</td></tr>
            <tr><td>V·ªã tr√≠</td><td>${data.city}, ${data.country}</td></tr>
        `;

        // K√≠ch ho·∫°t DataTables
        $('#ipTable').DataTable();
    }

    // G·ªçi API ƒë·ªÉ l·∫•y th√¥ng tin IP (thay th·∫ø b·∫±ng API ph√π h·ª£p)
    async function fetchIPInfo() {
        let response = await fetch("https://ipapi.co/json/");
        let data = await response.json();
        data.speed = Math.random() * 100 + 10; // Gi·∫£ l·∫≠p t·ªëc ƒë·ªô m·∫°ng
        updateTable(data);
    }

    fetchIPInfo();
</script>


    <script>
        function getInfo() {
            let infoDiv = document.getElementById('info');
            infoDiv.innerHTML = "<p class='loading'>‚è≥ ƒêang l·∫•y th√¥ng tin...</p>";

            fetch('https://ipapi.co/json/')
                .then(response => response.json())
                .then(data => {
                    let vpnStatus = data.proxy ? "üõë C√≥ s·ª≠ d·ª•ng VPN/Proxy" : "‚úÖ Kh√¥ng s·ª≠ d·ª•ng VPN/Proxy";
                    let ipInfo = `
                        <p><strong>üìå ƒê·ªãa ch·ªâ IP:</strong> ${data.ip}</p>
                        <p><strong>üì° Nh√† m·∫°ng (ISP):</strong> ${data.org}</p>
                        <p><strong>üåé Qu·ªëc gia:</strong> ${data.country_name}</p>
                        <p><strong>üèôÔ∏è Th√†nh ph·ªë:</strong> ${data.city}</p>
                        <p><strong>üïê M√∫i gi·ªù:</strong> ${data.timezone}</p>
                        <p><strong>üîç VPN/Proxy:</strong> ${vpnStatus}</p>
                    `;
                    infoDiv.innerHTML = ipInfo;

                    // Hi·ªÉn th·ªã b·∫£n ƒë·ªì
                    loadMap(parseFloat(data.latitude), parseFloat(data.longitude));

                    // Ki·ªÉm tra t·ªëc ƒë·ªô m·∫°ng
                    checkInternetSpeed(infoDiv);
                })
                .catch(() => {
                    infoDiv.innerHTML = `<p class="text-danger">‚ùå Kh√¥ng th·ªÉ l·∫•y th√¥ng tin IP.</p>`;
                });
        }

        // T·∫£i b·∫£n ƒë·ªì Google Maps
        function loadMap(lat, lon) {
            let map = new google.maps.Map(document.getElementById("map"), { center: { lat: lat, lng: lon }, zoom: 12 });
            new google.maps.Marker({ position: { lat: lat, lng: lon }, map: map });
        }

        // Ki·ªÉm tra t·ªëc ƒë·ªô m·∫°ng
        function checkInternetSpeed(infoDiv) {
            let startTime, endTime;
            let testImage = new Image();
            let imageSize = 1000000; // 1MB

            testImage.onload = function () {
                endTime = new Date().getTime();
                let duration = (endTime - startTime) / 1000;
                let speedMbps = ((imageSize * 8) / (duration * 1024 * 1024)).toFixed(2);
                
                infoDiv.innerHTML += `<p><strong>‚ö° T·ªëc ƒë·ªô Download:</strong> ${speedMbps} Mbps</p>`;
                checkUploadSpeed(infoDiv);
            };

            startTime = new Date().getTime();
            testImage.src = "https://upload.wikimedia.org/wikipedia/commons/3/3a/Example.jpg?t=" + startTime;
        }

        // Ki·ªÉm tra t·ªëc ƒë·ªô Upload
        function checkUploadSpeed(infoDiv) {
            let startTime, endTime;
            let data = new Blob([new ArrayBuffer(500000)]); // 500KB
            let formData = new FormData();
            formData.append("file", data);

            startTime = new Date().getTime();

            fetch("https://www.google.com/", { method: "POST", body: formData })
                .then(() => {
                    endTime = new Date().getTime();
                    let duration = (endTime - startTime) / 1000;
                    let speedMbps = ((500000 * 8) / (duration * 1024 * 1024)).toFixed(2);
                    
                    infoDiv.innerHTML += `<p><strong>‚¨ÜÔ∏è T·ªëc ƒë·ªô Upload:</strong> ${speedMbps} Mbps</p>`;
                })
                .catch(() => {
                    infoDiv.innerHTML += `<p><strong>‚¨ÜÔ∏è T·ªëc ƒë·ªô Upload:</strong> Kh√¥ng th·ªÉ ƒëo.</p>`;
                });
        }
    </script>
</style>


    <script async defer src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap"></script>

</body>
</html>
